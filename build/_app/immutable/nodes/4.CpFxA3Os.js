import{s as Me,c as z,a as f,d as Z,t as B,b as ie}from"../chunks/disclose-version.CyJLuhDn.js";import"../chunks/legacy.CRCYV9Jl.js";import{u as ze,C as Be,a as le,i as Re,T as Ae,c as ce,B as ue,b as I,A as De,O as Ie,d as a,e as Le,I as Te,f as Ge,P as Oe,g as Xe,M as Ee,h as We}from"../chunks/Mirror.BLHeOEJu.js";import{p as He,q as L,v as m,a as je,b as l,j as h,g as t,k as qe,o as n,f as F,w as ge}from"../chunks/utils.CQdqtoc_.js";import{c as s,i as de}from"../chunks/props.MNjYdPXW.js";import{p as $,o as Ze}from"../chunks/index-client.DzFwc65J.js";import{M as Fe,S as k}from"../chunks/store.2xqInZ_v.js";import{g as Je}from"../chunks/entry.Ce7bamsz.js";var Ke=B("<!> <!>",1),Qe=B("<!> <!> <!>",1),Ue=B("<!> <!>",1),Ve=B("<!> <!>",1),Ye=B("<!> <!> <!> <!>",1),Ne=B("<!> <!> <!> <!> <!> <!> <!> <!> <!>",1);function et(T,G){He(G,!0);const O=Me(),e=()=>ie(k,"$Settings",O),X=()=>ie(ye,"$hovering",O),pe=ze(),ve=$(pe.scene);ve.background=new Be(`rgb(${e().colours.background.r},${e().colours.background.g},${e().colours.background.b})`);let J=L($([]));const c=["Piano","Cube","Mirror"];let r=L(0),x=L($(e().colours.key)),K=L(!1);const fe=Fe.subscribe(o=>{m(J,$(o))});Ze(fe);function he(){t(r)>0?ge(r,-1):m(r,c.length-1),z(k,l(e).styleReset=!0,l(e)),z(k,l(e).scene=c[t(r)],l(e))}function _e(){t(r)>=0&&t(r)<c.length-1?ge(r):m(r,0),z(k,l(e).styleReset=!0,l(e)),z(k,l(e).scene=c[t(r)],l(e))}function E(o){z(k,l(e).scene=o,l(e)),m(K,!0),m(x,$({r:77,g:144,b:57})),j.set(0,{delay:250,duration:750,easing:ce}),setTimeout(()=>{setTimeout(()=>{Je("../play")},750)},750)}const{onPointerEnter:Q,onPointerLeave:U}=le(),{hovering:ye,onPointerEnter:W,onPointerLeave:H}=le();Re(),je(()=>{!X()&&!t(K)?m(x,$(e().colours.key)):m(x,$({r:77,g:144,b:57}))});const j=new Ae(0);j.set(50,{duration:1e3,easing:ce}),z(k,l(e).autoRotate=!1,l(e));var V=Ne(),Y=h(V);s(Y,()=>a.OrthographicCamera,(o,i)=>{i(o,{makeDefault:!0,position:[7.5,10,20],near:.001,far:5e3,get zoom(){return j.current},children:(g,_)=>{Ie(g,{enableDamping:!0,get autoRotateSpeed(){return e().autoRotateSpeed},get autoRotate(){return e().autoRotate},get enabled(){return e().orbitControls}})},$$slots:{default:!0}})});var N=n(Y,2);s(N,()=>a.DirectionalLight,(o,i)=>{i(o,{castShadow:!0,get intensity(){return e().lighting.front},position:[0,0,5]})});var ee=n(N,2);s(ee,()=>a.DirectionalLight,(o,i)=>{i(o,{castShadow:!0,get intensity(){return e().lighting.front},position:[0,0,-5]})});var te=n(ee,2);s(te,()=>a.DirectionalLight,(o,i)=>{i(o,{castShadow:!0,get intensity(){return e().lighting.side},position:[5,0,0]})});var oe=n(te,2);s(oe,()=>a.DirectionalLight,(o,i)=>{i(o,{castShadow:!0,get intensity(){return e().lighting.side},position:[-5,0,0]})});var re=n(oe,2);s(re,()=>a.AmbientLight,(o,i)=>{i(o,{get intensity(){return e().lighting.above},position:[0,15,0]})});var ne=n(re,2);ue(ne,{"position.y":7,children:(o,i)=>{var g=Ke(),_=h(g);I(_,{text:"Style",color:"orange",get font(){return e().font},fontSize:window.innerWidth/4e3,textAlign:"center",anchorX:"center","position.y":window.innerWidth/1250,outlineBlur:.1});var w=n(_,2);I(w,{text:"Play notes to sample, click to confirm style",color:"white",get font(){return e().font},fontSize:window.innerWidth/7e3,textAlign:"center",anchorX:"center",outlineBlur:.1}),f(o,g)},$$slots:{default:!0}});var ae=n(ne,2);De(ae,{y:!1,auto:!0,precise:!0,children:(o,i)=>{var g=Z(),_=h(g);s(_,()=>a.Group,(w,D)=>{D(w,{"position.y":-window.innerHeight/200,onpointerenter:W,onpointerleave:H,onclick:()=>E(c[t(r)]),children:(q,se)=>{var P=Z(),R=h(P);Le(R,17,()=>t(J),Ge,(A,u)=>{Te(A,{children:(y,b)=>{var S=Qe(),d=h(S);s(d,()=>a.BoxGeometry,(v,C)=>{C(v,{})});var p=n(d,2);s(p,()=>a.MeshStandardMaterial,(v,C)=>{C(v,{shadow:!0})});var $e=n(p,2);{var ke=v=>{Oe(v,{get position(){return t(u).position},get scale(){return t(u).scale},get velocity(){return t(u).velocity},get attack(){return e().attack},get release(){return e().release},get keyColour(){return t(x)},get expressionColour(){return e().colours.expression}})},xe=v=>{var C=Z(),we=h(C);{var Pe=M=>{var Se=F(()=>X()?250:e().attack),Ce=F(()=>X()?250:e().release);Xe(M,{get position(){return t(u).position},get scale(){return t(u).scale},get velocity(){return t(u).velocity},get attack(){return t(Se)},get release(){return t(Ce)},get keyColour(){return t(x)},get expressionColour(){return e().colours.expression}})},be=M=>{Ee(M,{get position(){return t(u).position},get scale(){return t(u).scale},get velocity(){return t(u).velocity},get attack(){return e().attack},get release(){return e().release},get keyColour(){return t(x)},get expressionColour(){return e().colours.expression}})};de(we,M=>{c[t(r)]==="Cube"?M(Pe):M(be,!1)},!0)}f(v,C)};de($e,v=>{c[t(r)]==="Piano"?v(ke):v(xe,!1)})}f(y,S)},$$slots:{default:!0}})}),f(q,P)},$$slots:{default:!0}})}),f(o,g)},$$slots:{default:!0}});var me=n(ae,2);ue(me,{"position.y":-window.innerHeight/140,children:(o,i)=>{var g=Ye(),_=h(g);s(_,()=>a.Mesh,(P,R)=>{R(P,{scale:.75,"position.x":7,"position.z":10,"rotation.z":-Math.PI/2,onpointerenter:Q,onpointerleave:U,onclick:()=>_e(),children:(A,u)=>{var y=Ue(),b=h(y);s(b,()=>a.ConeGeometry,(d,p)=>{p(d,{})});var S=n(b,2);s(S,()=>a.MeshBasicMaterial,(d,p)=>{p(d,{color:"orange",shadow:!0})}),f(A,y)},$$slots:{default:!0}})});var w=n(_,2);I(w,{get font(){return e().font},fontSize:.45,outlineBlur:.06,get text(){return c[t(r)]},textAlign:"center",anchorX:"center","position.x":0,"position.y":.5,"position.z":10,color:"white",onpointerenter:W,onpointerleave:H,onclick:()=>E(c[t(r)])});var D=n(w,2),q=F(()=>c[t(r)]==="Piano"?"Recommended for keyboards and synthesizers. Automapping enabled.":"Recommended for pads and samplers.");I(D,{get font(){return e().font},fontSize:.3,outlineBlur:.06,get text(){return t(q)},textAlign:"center",anchorX:"center","position.x":0,"position.y":-.25,"position.z":10,color:"white",onpointerenter:W,onpointerleave:H,onclick:()=>E(c[t(r)])});var se=n(D,2);s(se,()=>a.Mesh,(P,R)=>{R(P,{scale:.75,"position.x":-7,"position.z":10,"rotation.z":Math.PI/2,onpointerenter:Q,onpointerleave:U,onclick:()=>he(),children:(A,u)=>{var y=Ve(),b=h(y);s(b,()=>a.ConeGeometry,(d,p)=>{p(d,{})});var S=n(b,2);s(S,()=>a.MeshBasicMaterial,(d,p)=>{p(d,{color:"orange",shadow:!0})}),f(A,y)},$$slots:{default:!0}})}),f(o,g)},$$slots:{default:!0}}),f(T,V),qe()}function ct(T){We(T,{children:(G,O)=>{et(G,{})},$$slots:{default:!0}})}export{ct as component};
