var qe=a=>{throw TypeError(a)};var Te=(a,n,o)=>n.has(a)||qe("Cannot "+o);var i=(a,n,o)=>(Te(a,n,"read from private field"),o?o.call(a):n.get(a)),D=(a,n,o)=>n.has(a)?qe("Cannot add the same private member more than once"):n instanceof WeakSet?n.add(a):n.set(a,o),k=(a,n,o,e)=>(Te(a,n,"write to private field"),e?e.call(a,o):n.set(a,o),o),Je=(a,n,o)=>(Te(a,n,"access private method"),o);import{s as ct,c as Me,a as $,t as T,b as dt,d as $e}from"../chunks/disclose-version.CyJLuhDn.js";import"../chunks/legacy.CRCYV9Jl.js";import{r as ut,l as ht,j as Qe,u as gt,C as ft,i as pt,T as xe,c as fe,a as mt,O as vt,d,B as be,b as W,A as yt,e as wt,I as _t,f as Mt,P as $t,k as xt,g as bt,M as It,h as Pt}from"../chunks/Mirror.BLHeOEJu.js";import{F as pe,O as zt,v as f,P as St,n as At,g as t,p as Ct,q as V,b as q,j as x,k as Dt,o as c,t as kt,w as Be,f as ee}from"../chunks/utils.CQdqtoc_.js";import{s as Tt}from"../chunks/render.DKswsmsh.js";import{c as u,i as Ie}from"../chunks/props.MNjYdPXW.js";import{p as Z,o as Bt}from"../chunks/index-client.DzFwc65J.js";import{M as Wt,S as me}from"../chunks/store.2xqInZ_v.js";import{g as Xt}from"../chunks/entry.Ce7bamsz.js";function We(a,n,o,e){if(typeof o=="number"||Qe(o)){const z=e-o,m=(o-n)/(a.dt||1/60),Q=a.opts.stiffness*z,G=a.opts.damping*m,S=(Q-G)*a.inv_mass,U=(m+S)*a.dt;return Math.abs(U)<a.opts.precision&&Math.abs(z)<a.opts.precision?e:(a.settled=!1,Qe(o)?new Date(o.getTime()+U):o+U)}else{if(Array.isArray(o))return o.map((z,m)=>We(a,n[m],o[m],e[m]));if(typeof o=="object"){const z={};for(const m in o)z[m]=We(a,n[m],o[m],e[m]);return z}else throw new Error(`Cannot spring ${typeof o} values`)}}var te,oe,re,X,J,ne,de,ie,ve,N,ue,ze,Ue;const Ge=class Ge{constructor(n,o={}){D(this,ze);D(this,te,pe(.15));D(this,oe,pe(.8));D(this,re,pe(.01));D(this,X,pe(void 0));D(this,J,pe(void 0));D(this,ne);D(this,de,0);D(this,ie,1);D(this,ve,0);D(this,N,null);D(this,ue,null);i(this,X).v=i(this,J).v=n,typeof o.stiffness=="number"&&(i(this,te).v=Pe(o.stiffness,0,1)),typeof o.damping=="number"&&(i(this,oe).v=Pe(o.damping,0,1)),typeof o.precision=="number"&&(i(this,re).v=o.precision)}static of(n,o){const e=new Ge(n(),o);return zt(()=>{e.set(n())}),e}set(n,o){var z,m;if((z=i(this,ue))==null||z.reject(new Error("Aborted")),o!=null&&o.instant||i(this,X).v===void 0)return(m=i(this,N))==null||m.abort(),k(this,N,null),f(i(this,X),f(i(this,J),n)),k(this,ne,n),Promise.resolve();o!=null&&o.preserveMomentum&&(k(this,ie,0),k(this,ve,o.preserveMomentum));var e=k(this,ue,St());return e.promise.catch(At),Je(this,ze,Ue).call(this,n).then(()=>{e===i(this,ue)&&e.resolve(void 0)}),e.promise}get current(){return t(i(this,X))}get damping(){return t(i(this,oe))}set damping(n){f(i(this,oe),Pe(n,0,1))}get precision(){return t(i(this,re))}set precision(n){f(i(this,re),n)}get stiffness(){return t(i(this,te))}set stiffness(n){f(i(this,te),Pe(n,0,1))}get target(){return t(i(this,J))}set target(n){this.set(n)}};te=new WeakMap,oe=new WeakMap,re=new WeakMap,X=new WeakMap,J=new WeakMap,ne=new WeakMap,de=new WeakMap,ie=new WeakMap,ve=new WeakMap,N=new WeakMap,ue=new WeakMap,ze=new WeakSet,Ue=function(n){var e;if(f(i(this,J),n),(e=i(this,X)).v??(e.v=n),i(this,ne)??k(this,ne,i(this,X).v),!i(this,N)){k(this,de,ut.now());var o=1e3/(i(this,ve)*60);i(this,N)??k(this,N,ht(z=>{k(this,ie,Math.min(i(this,ie)+o,1));const m={inv_mass:i(this,ie),opts:{stiffness:i(this,te).v,damping:i(this,oe).v,precision:i(this,re).v},settled:!0,dt:(z-i(this,de))*60/1e3};var Q=We(m,i(this,ne),i(this,X).v,i(this,J).v);return k(this,ne,i(this,X).v),k(this,de,z),f(i(this,X),Q),m.settled&&k(this,N,null),!m.settled}))}return i(this,N).promise};let Xe=Ge;function Pe(a,n,o){return Math.max(n,Math.min(o,a))}var Gt=T("<!> <!> <!>",1),Ht=T("<!> <!> <!> <!> <!> <!>",1),Ft=T(" <!> <!>",1),Ot=T("<!> <!> <!>",1),Lt=T("<!> <!> <!>",1),Yt=T("<!> <!>",1),jt=T("<!> <!>",1),Et=T("<!> <!>",1),Rt=T("<!> <!> <!>",1),Zt=T("<!> <!>",1),Nt=T("<!> <!> <!>",1),Kt=T("<!> <!> <!> <!>",1),qt=T("<!> <!> <!> <!> <!> <!> <!>",1);function Jt(a,n){Ct(n,!0);const o=ct(),e=()=>dt(me,"$Settings",o),z=gt(),m=Z(z.scene);m.background=new ft(`rgb(${e().colours.background.r},${e().colours.background.g},${e().colours.background.b})`),pt();let Q=[],G=[],S=V(Z([])),U=V(!1),He=V("Swipe to rotate the scene");const ye=new xe(0),Se=new Xe(6),we=new xe(1,{duration:1e3,easing:fe}),Fe=new xe(0,{duration:1e3,easing:fe}),_e=new xe(0,{delay:1e3,duration:1e3,easing:fe}),K=["Piano","Cube","Mirror"];let A=V(0),he=V(0),F=V(12),ge;const Ae=[{key:{r:141,g:154,b:203},expression:{r:254,g:228,b:129}},{key:{r:0,g:83,b:56},expression:{r:255,g:5,b:86}},{key:{r:77,g:12,b:55},expression:{r:255,g:122,b:255}}],Oe="Welcome to GIDI",Le=`GIDI is a free, open source web application for musicians using MIDI devices

By reading MIDI messages it can visualise a performance on a web browser`,{onPointerEnter:Ce,onPointerLeave:De}=mt();let se=V(Z([{}]));if(window.innerWidth>window.innerHeight){ye.set(50,{delay:200,duration:1e3,easing:fe});const l=Wt.subscribe(s=>{f(se,Z(s))});Bt(l)}else{let l=0,s=0,H=1,O=1,L=1,E;const ae=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];ye.set(35,{delay:200,duration:1e3,easing:fe}),f(U,!0),Me(me,q(e).attack=75,q(e)),Me(me,q(e).release=1e3,q(e));for(let r=0;r<7;r++)Q.push({note:r,velocity:0,position:{x:r,y:0,z:0},scale:{x:1,y:1,z:1}});for(let r=0;r<12;r++)ae[r%12].includes("#")?(l=.75,s=-1.5,H=.5,O=.5,L=2):(l=0,s=-1,H=1,O=1,L=3),G.push({note:r,velocity:0,position:{x:r,y:l,z:s},scale:{x:H,y:O,z:L}});let v=G.filter(r=>r.scale.x===1),B=G.filter(r=>r.scale.x===.5);v=v.map((r,h)=>({note:r.note,velocity:r.velocity,position:{x:h,y:r.position.y,z:r.position.z},scale:{x:r.scale.x,y:r.scale.y,z:r.scale.z}})),B=B.map((r,h)=>(E=v.find(P=>P.note===r.note-1),{note:r.note,velocity:r.velocity,position:{x:E.position.x+.5,y:r.position.y,z:r.position.z},scale:{x:r.scale.x,y:r.scale.y,z:r.scale.z}})),G=[...v,...B],G=G.toSorted((r,h)=>r.note-h.note),f(S,Z(G)),ge=setTimeout(r=>{setInterval(()=>{let h=Math.floor(Math.random()*t(F));for(;h==r;)h=Math.floor(Math.random()*t(F));t(S)[h].velocity=(Math.random()+1)*63.5,setTimeout(()=>{t(S)[h].velocity=0},Math.floor(Math.random()*1e3)),r=h},Math.floor((Math.random()+.5)*500))},500)}function Ve(){setTimeout(()=>{ye.set(0,{duration:750,easing:xt}),setTimeout(()=>{Xt("./style")},1e3)},2e3)}function et(){t(A)>0?Be(A,-1):f(A,K.length-1),K[t(A)]==="Piano"?(f(S,Z(G)),f(F,12)):(f(S,Z(Q)),f(F,7)),clearTimeout(ge),ge=setTimeout(l=>{setInterval(()=>{let s=Math.floor(Math.random()*t(F));for(;s==l;)s=Math.floor(Math.random()*t(F));t(S)[s].velocity=(Math.random()+1)*63.5,setTimeout(()=>{t(S)[s].velocity=0},Math.floor(Math.random()*1e3)),l=s},Math.floor((Math.random()+.5)*500))},500)}function tt(){t(A)>=0&&t(A)<K.length-1?Be(A):f(A,0),K[t(A)]==="Piano"?(f(S,Z(G)),f(F,12)):(f(S,Z(Q)),f(F,7)),clearTimeout(ge),ge=setTimeout(l=>{setInterval(()=>{let s=Math.floor(Math.random()*t(F));for(;s==l;)s=Math.floor(Math.random()*t(F));t(S)[s].velocity=(Math.random()+1)*63.5,setTimeout(()=>{t(S)[s].velocity=0},Math.floor(Math.random()*1e3)),l=s},Math.floor((Math.random()+.5)*500))},500)}var Ye=qt(),je=x(Ye);u(je,()=>d.OrthographicCamera,(l,s)=>{s(l,{makeDefault:!0,position:[5,3,4],near:.001,far:5e3,get zoom(){return ye.current},children:(H,O)=>{var L=ee(()=>!t(U));vt(H,{get enabled(){return t(U)},get autoRotate(){return t(L)},enableDamping:!0,enablePan:!1,enableZoom:!1,rotateSpeed:2,maxPolarAngle:Math.PI/2.15,minPolarAngle:Math.PI/4,onstart:E=>{Fe.target=.75,f(He,"To shuffle colours tap here")}})},$$slots:{default:!0}})});var Ee=c(je,2);u(Ee,()=>d.DirectionalLight,(l,s)=>{s(l,{castShadow:!0,get intensity(){return e().lighting.front},position:[0,0,5]})});var Re=c(Ee,2);u(Re,()=>d.DirectionalLight,(l,s)=>{s(l,{castShadow:!0,get intensity(){return e().lighting.front},position:[0,0,-5]})});var Ze=c(Re,2);u(Ze,()=>d.DirectionalLight,(l,s)=>{s(l,{castShadow:!0,get intensity(){return e().lighting.side},position:[5,0,0]})});var Ne=c(Ze,2);u(Ne,()=>d.DirectionalLight,(l,s)=>{s(l,{castShadow:!0,get intensity(){return e().lighting.side},position:[-5,0,0]})});var Ke=c(Ne,2);u(Ke,()=>d.AmbientLight,(l,s)=>{s(l,{get intensity(){return e().lighting.above},position:[0,15,0]})});var ot=c(Ke,2);{var rt=l=>{var s=Ft(),H=x(s);kt(()=>Tt(H,`${(t(se).length>0?Ve():null)??""} `));var O=c(H);be(O,{"position.y":7,children:(E,ae)=>{var v=$e(),B=x(v);u(B,()=>d.Mesh,(r,h)=>{h(r,{children:(P,Y)=>{var _=Gt(),b=x(_);W(b,{text:Oe,color:"orange",get font(){return e().font},fontSize:window.innerWidth/4e3,textAlign:"center",anchorX:"center","position.y":window.innerWidth/1250,outlineBlur:.1});var M=c(b,2);W(M,{text:Le+`



To start using GIDI follow the steps below:`,get font(){return e().font},fontSize:window.innerWidth/7e3,textAlign:"center",smooth:1,anchorX:"center",outlineBlur:.1});var p=c(M,2);W(p,{text:`1. Connect a MIDI instrument to your device

2. Play a note

3. If the box turns green you are connected`,get font(){return e().font},fontSize:window.innerWidth/6250,color:"orange",textAlign:"left",smooth:1,anchorX:"center","position.y":-window.innerWidth/500,outlineBlur:.1}),$(P,_)},$$slots:{default:!0}})}),$(E,v)},$$slots:{default:!0}});var L=c(O,2);u(L,()=>d.Mesh,(E,ae)=>{ae(E,{position:[0,-window.innerWidth/300,0],interactive:!0,onpointerenter:()=>Se.set(8),onpointerleave:()=>Se.set(6),children:(v,B)=>{var r=Ht(),h=x(r),P=ee(()=>t(se).length===0?"Connect A MIDI Device":"MIDI Connected");W(h,{get text(){return t(P)},get font(){return e().font},fontSize:.5,textAlign:"center",smooth:1,anchorX:"center",anchorY:"middle",position:[0,.8,0],rotation:[-1.553343,0,0],outlineBlur:.06});var Y=c(h,2),_=ee(()=>t(se).length===0?"No MIDI Device Found":"Initialising");W(Y,{get text(){return t(_)},get font(){return e().font},fontSize:.5,textAlign:"center",smooth:1,anchorX:"center",anchorY:"middle",position:[0,0,1.02],outlineBlur:.06});var b=c(Y,2),M=ee(()=>t(se).length===0?"No MIDI Device Found":"Initialising");W(b,{get text(){return t(M)},get font(){return e().font},fontSize:.5,textAlign:"center",smooth:1,anchorX:"center",anchorY:"middle",position:[0,0,-1.02],"rotation.y":3.14,outlineBlur:.06});var p=c(b,2);u(p,()=>d.MeshStandardMaterial,(g,R)=>{R(g,{shadow:!0,color:"#FD3F00",toneMapped:!1,metalness:1,roughness:.1})});var y=c(p,2),I=ee(()=>[Se.current,1.5,2]);u(y,()=>d.BoxGeometry,(g,R)=>{R(g,{get args(){return t(I)}})});var C=c(y,2),w=ee(()=>t(se).length===0?"darkred":"green");u(C,()=>d.MeshStandardMaterial,(g,R)=>{R(g,{get color(){return t(w)}})}),$(v,r)},$$slots:{default:!0}})}),$(l,s)},nt=l=>{var s=Kt(),H=x(s);be(H,{children:(v,B)=>{var r=$e(),h=x(r);u(h,()=>d.Mesh,(P,Y)=>{Y(P,{position:[0,8,0],children:(_,b)=>{var M=Ot(),p=x(M);W(p,{text:Oe,color:"orange",get font(){return e().font},fontSize:window.innerWidth/600,textAlign:"center",anchorX:"center","position.y":window.innerHeight/350});var y=c(p,2);W(y,{text:Le,get font(){return e().font},fontSize:window.innerWidth/1500,textAlign:"center",smooth:1,anchorX:"center","position.y":window.innerHeight/750});var I=c(y,2);W(I,{text:"Try the demo below or revisit this site on a computer",get font(){return e().font},fontSize:window.innerWidth/1250,textAlign:"center",color:"orange",smooth:1,anchorX:"center","position.y":-window.innerHeight/1250}),$(_,M)},$$slots:{default:!0}})}),$(v,r)},$$slots:{default:!0}});var O=c(H,2);u(O,()=>d.Group,(v,B)=>{B(v,{position:[0,-window.innerHeight/200,0],onpointerenter:Ce,onpointerleave:De,onclick:()=>{we.target=0,_e.target=.75,Me(me,q(e).colours.key=Ae[t(he)].key,q(e)),Me(me,q(e).colours.expression=Ae[t(he)].expression,q(e)),t(he)>=Ae.length-1?f(he,0):Be(he)},children:(r,h)=>{yt(r,{children:(P,Y)=>{var _=$e(),b=x(_);wt(b,17,()=>t(S),Mt,(M,p)=>{_t(M,{children:(y,I)=>{var C=Lt(),w=x(C);u(w,()=>d.BoxGeometry,(j,le)=>{le(j,{})});var g=c(w,2);u(g,()=>d.MeshStandardMaterial,(j,le)=>{le(j,{shadow:!0})});var R=c(g,2);{var ke=j=>{$t(j,{get position(){return t(p).position},get scale(){return t(p).scale},get velocity(){return t(p).velocity},get attack(){return e().attack},get release(){return e().release},get keyColour(){return e().colours.key},get expressionColour(){return e().colours.expression}})},it=j=>{var le=$e(),st=x(le);{var at=ce=>{bt(ce,{get position(){return t(p).position},get scale(){return t(p).scale},get velocity(){return t(p).velocity},get attack(){return e().attack},get release(){return e().release},get keyColour(){return e().colours.key},get expressionColour(){return e().colours.expression}})},lt=ce=>{It(ce,{get position(){return t(p).position},get scale(){return t(p).scale},get velocity(){return t(p).velocity},get attack(){return e().attack},get release(){return e().release},get keyColour(){return e().colours.key},get expressionColour(){return e().colours.expression}})};Ie(st,ce=>{K[t(A)]==="Cube"?ce(at):ce(lt,!1)},!0)}$(j,le)};Ie(R,j=>{K[t(A)]=="Piano"?j(ke):j(it,!1)})}$(y,C)},$$slots:{default:!0}})}),$(P,_)},$$slots:{default:!0}})},$$slots:{default:!0}})});var L=c(O,2);{var E=v=>{be(v,{"position.y":-window.innerHeight/80,children:(B,r)=>{var h=jt(),P=x(h);u(P,()=>d.Mesh,(_,b)=>{b(_,{get scale(){return Fe.current},"position.y":window.innerHeight/550,"position.z":7,children:(M,p)=>{var y=Yt(),I=x(y);u(I,()=>d.ConeGeometry,(w,g)=>{g(w,{})});var C=c(I,2);u(C,()=>d.MeshBasicMaterial,(w,g)=>{g(w,{color:"orange",transparent:!0,get opacity(){return we.current}})}),$(M,y)},$$slots:{default:!0}})});var Y=c(P,2);W(Y,{get fillOpacity(){return we.current},get text(){return t(He)},color:"orange",get font(){return e().font},fontSize:window.innerWidth/1250,textAlign:"center",anchorX:"center","position.y":window.innerHeight/1250,"position.z":7}),$(B,h)},$$slots:{default:!0}})};Ie(L,v=>{v(E)})}var ae=c(L,2);be(ae,{"position.y":-window.innerHeight/90,children:(v,B)=>{var r=Nt(),h=x(r);u(h,()=>d.Mesh,(_,b)=>{b(_,{receiveShadow:!0,get scale(){return _e.current},"position.x":4.5,"rotation.z":-Math.PI/2,onpointerenter:Ce,onpointerleave:De,onclick:()=>tt(),children:(M,p)=>{var y=Et(),I=x(y);u(I,()=>d.ConeGeometry,(w,g)=>{g(w,{})});var C=c(I,2);u(C,()=>d.MeshBasicMaterial,(w,g)=>{g(w,{color:"orange",shadow:!0})}),$(M,y)},$$slots:{default:!0}})});var P=c(h,2);u(P,()=>d.Mesh,(_,b)=>{b(_,{get scale(){return _e.current},children:(M,p)=>{var y=Rt(),I=x(y);W(I,{get font(){return e().font},fontSize:.6,outlineBlur:.06,get text(){return K[t(A)]},textAlign:"center",anchorX:"center","position.x":0,"position.y":.5,"position.z":7,color:"white","}":!0});var C=c(I,2),w=ee(()=>K[t(A)]==="Piano"?`Recommended for keyboards and synthesizers.
Automapping enabled.`:"Recommended for pads and samplers.");W(C,{get font(){return e().font},fontSize:.4,outlineBlur:.06,get text(){return t(w)},textAlign:"center",anchorX:"center","position.x":0,"position.y":-.25,"position.z":7,color:"white","}":!0});var g=c(C,2);u(g,()=>d.MeshBasicMaterial,(R,ke)=>{ke(R,{color:"orange",transparent:!0,get opacity(){return we.current}})}),$(M,y)},$$slots:{default:!0}})});var Y=c(P,2);u(Y,()=>d.Mesh,(_,b)=>{b(_,{get scale(){return _e.current},"position.x":-4.5,"rotation.z":Math.PI/2,onpointerenter:Ce,onpointerleave:De,onclick:()=>et(),children:(M,p)=>{var y=Zt(),I=x(y);u(I,()=>d.ConeGeometry,(w,g)=>{g(w,{})});var C=c(I,2);u(C,()=>d.MeshBasicMaterial,(w,g)=>{g(w,{color:"orange",shadow:!0})}),$(M,y)},$$slots:{default:!0}})}),$(v,r)},$$slots:{default:!0}}),$(l,s)};Ie(ot,l=>{window.innerWidth>window.innerHeight?l(rt):l(nt,!1)})}$(a,Ye),Dt()}function ao(a){Pt(a,{children:(n,o)=>{Jt(n,{})},$$slots:{default:!0}})}export{ao as component};
